---
title: "R Notebook"
output: html_notebook
---

###1. Pigeon schematic

#### Load data

```{R}

load( file.path (PROJHOME , "Output" , "nn-coh.rda"))

```

```{R}
floor(floor(dim(nn.coh)[1]/5/60)/3)

mins = 5
step.len = 5*5*60
len = floor(97/mins)
step = rep(step.len, len)
cum.step = c(1,cumsum(step)+1)

mean = rep(NA,len)
sd   = rep(NA,len)
for ( i in 1:len){
  mean[i] = mean(nn.coh[cum.step[i]:cum.step[i+1],])
  sd  [i] = sd  (nn.coh[cum.step[i]:cum.step[i+1],])
}

mean
```

```{R}
if( !file.exists( PROJHOME , "Figures", "pidge.schem.pdf")){
pdf( file.path (PROJHOME, "Figures" , "pidge.schem.pdf"))
mean2 = mean/2
mean2 = mean/2

par( mar = c(5,5,5,5))
plot(-15:15,seq(-4,4,length.out = 31) ,type = "n", bty = "n", yaxt = "n", xaxt = "n", ylab = "", xlab = "")
axis( 2, at= c(-4,-2,0,2), labels = c(0,2,4,6))
mtext ( "Distance (m)", 2 , line = 3)
segments( -9,0-mean2[1],-9,0+mean2[1])
#points(-9,0)
#segments( -9-sd[1],0 ,-9+sd[1],0)

segments( 9,0-mean2[len],9,0+mean2[len])
#points(9,0)
#segments( 9-sd[len],0 ,9+sd[len],0)

dev.off()
} 
mean2 = mean/2
mean2 = mean/2

par( mar = c(5,5,5,5))
plot(-15:15,seq(-4,4,length.out = 31) ,type = "n", bty = "n", yaxt = "n", xaxt = "n", ylab = "", xlab = "")
axis( 2, at= c(-4,-2,0,2), labels = c(0,2,4,6))
mtext ( "Distance (m)", 2 , line = 3)
segments( -9,0-mean2[1],-9,0+mean2[1])
#points(-9,0)
#segments( -9-sd[1],0 ,-9+sd[1],0)

segments( 9,0-mean2[len],9,0+mean2[len])
#points(9,0)
#segments( 9-sd[len],0 ,9+sd[len],0)

```